<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>QGroundControl Plan Generator</title>
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <div class="app-container">
      <!-- Header -->
      <header class="header">
        <div class="header-content">
          <h1>QGroundControl Plan Generator</h1>
          <div class="header-actions">
            <button id="load-sample" class="btn btn--secondary">
              Load Sample Data
            </button>
            <button id="upload-geojson" class="btn btn--outline">
              Upload GeoJSON
            </button>
            <input
              type="file"
              id="geojson-file"
              accept=".geojson,.json"
              style="display: none"
            />
          </div>
        </div>
      </header>

      <!-- Main Content -->
      <main class="main-content">
        <!-- Left Panel - Configuration -->
        <aside class="left-panel">
          <div class="panel-content">
            <!-- GeoJSON Upload Area -->
            <div class="form-section">
              <h3>Boundary Data</h3>
              <div id="drop-zone" class="drop-zone">
                <div class="drop-zone-content">
                  <p>Drop GeoJSON file here or click to upload</p>
                  <small>Supported: .geojson, .json</small>
                </div>
              </div>
              <div id="boundary-info" class="boundary-info hidden">
                <p><strong>Loaded:</strong> <span id="boundary-name"></span></p>
                <p>
                  <strong>Area:</strong> <span id="boundary-area"></span> m²
                </p>
              </div>
            </div>

            <!-- Vehicle Configuration -->
            <div class="form-section">
              <h3>Vehicle Configuration</h3>
              <div class="form-group">
                <label for="vehicle-type" class="form-label">Vehicle Type</label>
                <select id="vehicle-type" class="form-control">
                  <option value="2">Multi-Rotor</option>
                  <option value="1">Fixed Wing</option>
                  <option value="10">Ground Vehicle</option>
                  <option value="19">VTOL</option>
                </select>
              </div>
              <div class="form-group">
                <label for="firmware-type" class="form-label">Firmware Type</label>
                <select id="firmware-type" class="form-control">
                  <option value="12">PX4</option>
                  <option value="3">ArduPilot</option>
                </select>
              </div>
            </div>

            <!-- Flight Parameters -->
            <div class="form-section">
              <h3>Flight Parameters</h3>
              <div class="form-group">
                <label for="altitude" class="form-label">Altitude (m)</label>
                <input
                  type="number"
                  id="altitude"
                  class="form-control"
                  value="120"
                  min="5"
                  max="500"
                  step="1"
                  required
                />
                <div class="error-message" id="altitude-error"></div>
              </div>
              <div class="form-group">
                <label for="cruise-speed" class="form-label">Cruise Speed (m/s)</label>
                <input
                  type="number"
                  id="cruise-speed"
                  class="form-control"
                  value="15"
                  min="1"
                  max="30"
                  step="0.1"
                  required
                />
                <div class="error-message" id="cruise-speed-error"></div>
              </div>
              <div class="form-group">
                <label for="hover-speed" class="form-label">Hover Speed (m/s)</label>
                <input
                  type="number"
                  id="hover-speed"
                  class="form-control"
                  value="5"
                  min="1"
                  max="15"
                  step="0.1"
                  required
                />
                <div class="error-message" id="hover-speed-error"></div>
              </div>
              <div class="form-group">
                <label for="altitude-mode">Altitude Mode</label>
                <select id="altitude-mode" class="form-control">
                  <option value="1">Relative to Home</option>
                  <option value="2">Absolute (MSL)</option>
                  <option value="3">Above Terrain</option>
                  <option value="4" selected>Terrain Frame</option>
                </select>
              </div>
            </div>

            <!-- Mission Pattern -->
            <div class="form-section">
              <h3>Mission Pattern</h3>
              <div class="form-group">
                <label for="pattern-type" class="form-label">Pattern Type</label>
                <select id="pattern-type" class="form-control">
                  <option value="survey">Survey Grid</option>
                  <option value="perimeter">Perimeter</option>
                  <option value="vertices">Vertices Only</option>
                </select>
              </div>
              <div class="form-group" id="turn-waypoints-group" style="display: none">
                <label>
                  <input type="checkbox" id="turn-waypoints-only" checked/>
                  Turn Waypoints Only
                </label>
                <small>Show only direction change waypoints</small>
              </div>
            </div>

            <!-- Advanced Options -->
            <div class="form-section">
              <div class="collapsible-header" id="advanced-toggle">
                <h3>Advanced Options</h3>
                <span class="toggle-icon">▼</span>
              </div>
              <div id="advanced-options" class="collapsible-content">
                <div class="form-group">
                  <label for="turn-around-distance" class="form-label">Turn Around Distance (m)</label>
                  <input
                    type="number"
                    id="turn-around-distance"
                    class="form-control"
                    value="10"
                    min="5"
                    max="100"
                    step="1"
                  />
                </div>
                <div class="form-group">
                  <label for="grid-angle" class="form-label">
                    Grid Angle: <span id="grid-angle-value">0°</span>
                  </label>
                  <input
                    type="range"
                    id="grid-angle"
                    class="form-control"
                    value="0"
                    min="0"
                    max="360"
                  />
                </div>
                <div class="form-group">
                  <label>
                    <input type="checkbox" id="camera-trigger" checked />
                    Enable Camera Trigger
                  </label>
                </div>
              </div>
            </div>

            <!-- Camera Settings -->
            <div class="form-section" id="camera-settings" style="display: block">
              <h3>Camera Settings</h3>
              <div class="form-group">
                <label for="camera-name" class="form-label">Camera</label>
                <select id="camera-name" class="form-control">
                  <option value="Custom Camera">Custom Camera</option>
                  <option value="Sony ILCE-QX1">Sony ILCE-QX1</option>
                  <option value="Manual">Manual</option>
                </select>
              </div>
              <div class="camera-specs">
                <div class="form-group">
                  <label for="image-width" class="form-label">Image Width (px)</label>
                  <input
                    type="number"
                    id="image-width"
                    class="form-control"
                    value="4000"
                    min="100"
                    required
                  />
                </div>
                <div class="form-group">
                  <label for="image-height" class="form-label">Image Height (px)</label>
                  <input
                    type="number"
                    id="image-height"
                    class="form-control"
                    value="3000"
                    min="100"
                    required
                  />
                </div>
                <div class="form-group">
                  <label for="sensor-width" class="form-label">Sensor Width (mm)</label>
                  <input
                    type="number"
                    id="sensor-width"
                    class="form-control"
                    value="6.17"
                    step="0.01"
                    min="0.1"
                    required
                  />
                </div>
                <div class="form-group">
                  <label for="sensor-height" class="form-label">Sensor Height (mm)</label>
                  <input
                    type="number"
                    id="sensor-height"
                    class="form-control"
                    value="4.55"
                    step="0.01"
                    min="0.1"
                    required
                  />
                </div>
                <div class="form-group">
                  <label for="focal-length" class="form-label">Focal Length (mm)</label>
                  <input
                    type="number"
                    id="focal-length"
                    class="form-control"
                    value="4.5"
                    step="0.1"
                    min="0.1"
                    required
                  />
                </div>
                <div class="form-group">
                  <label for="frontal-overlap" class="form-label">Frontal Overlap (%)</label>
                  <input
                    type="number"
                    id="frontal-overlap"
                    class="form-control"
                    value="70"
                    min="50"
                    max="90"
                    step="1"
                    required
                  />
                </div>
                <div class="form-group">
                  <label for="side-overlap" class="form-label">Side Overlap (%)</label>
                  <input
                    type="number"
                    id="side-overlap"
                    class="form-control"
                    value="70"
                    min="50"
                    max="90"
                    step="1"
                    required
                  />
                </div>
                <div class="form-group">
                  <label for="min-trigger-interval" class="form-label">Min Trigger Interval (s)</label>
                  <input
                    type="number"
                    id="min-trigger-interval"
                    class="form-control"
                    value="1"
                    min="0.1"
                    step="0.1"
                    required
                  />
                </div>
              </div>
            </div>

            <!-- Generate Button -->
            <div class="form-section">
              <button id="generate-plan" class="btn btn--primary btn--full-width">
                Generate Plan
              </button>
              <div class="progress-bar hidden" id="progress-bar">
                <div class="progress-bar-fill" id="progress-fill"></div>
              </div>
            </div>
          </div>
        </aside>

        <!-- Center Panel - Map -->
        <section class="center-panel">
          <div id="map"></div>
          <div id="loading" class="loading-overlay hidden">
            <div class="loading-content">
              <div class="loading-spinner"></div>
              <p>Generating plan...</p>
            </div>
          </div>
        </section>

        <!-- Right Panel - Preview and Export -->
        <aside class="right-panel">
          <div class="panel-content">
            <!-- Mission Statistics -->
            <div class="stats-section">
              <h3>Mission Statistics</h3>
              <div class="stats-grid">
                <div class="stat-item">
                  <span class="stat-label">Waypoints</span>
                  <span class="stat-value" id="stat-waypoints">0</span>
                </div>
                <div class="stat-item">
                  <span class="stat-label">Distance</span>
                  <span class="stat-value" id="stat-distance">0 m</span>
                </div>
                <div class="stat-item">
                  <span class="stat-label">Flight Time</span>
                  <span class="stat-value" id="stat-time">0 min</span>
                </div>
                <div class="stat-item">
                  <span class="stat-label">Camera Shots</span>
                  <span class="stat-value" id="stat-shots">0</span>
                </div>
                <div class="stat-item">
                  <span class="stat-label">Area</span>
                  <span class="stat-value" id="stat-area">0 m²</span>
                </div>
                <div class="stat-item">
                  <span class="stat-label">Plan Status</span>
                  <span class="stat-value" id="plan-status">
                    <span class="status status--info">Ready</span>
                  </span>
                </div>
              </div>
            </div>

            <!-- Plan Preview -->
            <div class="preview-section">
              <h3>Plan Preview</h3>
              <div class="preview-container">
                <pre id="plan-preview" class="plan-preview">No plan generated</pre>
              </div>
            </div>

            <!-- Export Buttons -->
            <div class="export-section">
              <h3>Export</h3>
              <div class="export-buttons">
                <button id="export-plan" class="btn btn--primary btn--full-width" disabled>
                  Download .plan File
                </button>
                <button id="export-json" class="btn btn--outline btn--full-width" disabled>
                  Export JSON
                </button>
                <button id="export-csv" class="btn btn--outline btn--full-width" disabled>
                  Export CSV
                </button>
              </div>
            </div>
          </div>
        </aside>
      </main>
    </div>

    <script src="app.js"></script>
  </body>
</html>